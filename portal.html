<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Host Portal - Nova Stays KE</title>
  <script src="https://cdn.tailwindcss.com"></script>
</head>
<body class="bg-gray-50">

  <!-- Header -->
  <header class="flex justify-between items-center p-4 bg-white shadow-md">
    <div class="text-xl font-bold text-green-600">Nova Stays KE</div>
    <div id="hostInfo" class="text-sm text-right text-gray-700">
      <div id="hostName">Host Name</div>
      <div id="hostEmail">host@example.com</div>
      <div id="hostPhone">+254700000000</div>
    </div>
  </header>

  <!-- Listings Container -->
  <main class="max-w-4xl mx-auto p-6">
    <h2 class="text-2xl font-semibold text-gray-800 mb-4">Your Listings</h2>
    <div id="listingsContainer" class="grid gap-6"></div>
  </main>

  <!-- Modal -->
  <div id="modal" class="hidden fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center">
    <div class="bg-white p-6 rounded shadow-md w-80">
      <h3 class="text-lg font-semibold mb-2 text-red-600">Verification Failed</h3>
      <p class="text-sm text-gray-600">The code entered is incorrect. Listing is not verified.</p>
      <button onclick="closeModal()" class="mt-4 bg-red-600 text-white px-4 py-2 rounded">Close</button>
    </div>
  </div>

  <script>
    // Placeholder host data (would come from login in full version)
    const hostDetails = {
      name: "Jane Doe",
      email: "jane.doe@example.com",
      phone: "+254712345678"
    };

    // Inject host details
    document.getElementById("hostName").textContent = hostDetails.name;
    document.getElementById("hostEmail").textContent = hostDetails.email;
    document.getElementById("hostPhone").textContent = hostDetails.phone;

    // Load from localStorage
    function loadListings() {
      return JSON.parse(localStorage.getItem("novaStaysListings") || "[]");
    }

    // Save to localStorage
    function saveListings(data) {
      localStorage.setItem("novaStaysListings", JSON.stringify(data));
    }

    function renderListings() {
      const container = document.getElementById("listingsContainer");
      container.innerHTML = "";
      const listings = loadListings();

      listings.forEach(listing => {
        const card = document.createElement("div");
        card.className = "bg-white rounded-lg shadow-md p-4 flex flex-col md:flex-row gap-4";

        card.innerHTML = `
          <img src="${listing.images[0]}" alt="Image" class="w-32 h-32 object-cover rounded">
          <div class="flex-1">
            <h3 class="text-lg font-bold">${listing.title}</h3>
            <p class="text-sm text-gray-600">${listing.location}</p>
            <p class="text-green-700 font-semibold mt-1">$${listing.price} / night</p>
            <div class="flex items-center mt-2">
              <span id="status-${listing.id}" class="text-xs px-2 py-1 rounded-full ${listing.verified ? 'bg-green-100 text-green-700' : 'bg-yellow-100 text-yellow-700'}">
                ${listing.verified ? '<span class="inline-block w-2 h-2 bg-green-600 rounded-full mr-1"></span> Live' : 'Pending Verification'}
              </span>
            </div>
            <div class="mt-4 space-x-2">
              <button onclick="editListing(${listing.id})" class="text-sm text-blue-600">Edit</button>
              <button onclick="deleteListing(${listing.id})" class="text-sm text-red-600">Delete</button>
              ${!listing.verified ? `
                <input id="code-${listing.id}" class="border px-2 py-1 text-sm w-24" placeholder="Code">
                <button onclick="verifyListing(${listing.id})" class="text-sm bg-green-600 text-white px-2 py-1 rounded">Verify</button>
              ` : ''}
            </div>
          </div>
        `;

        container.appendChild(card);
      });
    }

    function deleteListing(id) {
      const listings = loadListings();
      const updated = listings.filter(l => l.id !== id);
      saveListings(updated);
      renderListings();
    }

    function verifyListing(id) {
      const code = document.getElementById(`code-${id}`).value.trim();
      if (code === "1234") {
        const listings = loadListings();
        const listing = listings.find(l => l.id === id);
        if (listing) {
          listing.verified = true;
          saveListings(listings);
          renderListings();
        }
      } else {
        document.getElementById("modal").classList.remove("hidden");
      }
    }

    function closeModal() {
      document.getElementById("modal").classList.add("hidden");
    }

    function editListing(id) {
      alert("Edit function not yet implemented.");
    }

    // Initial render
    renderListings();
  </script>
</body>
</html>
